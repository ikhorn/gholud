/* ������ ��� ������ � ������
 * ��������������� ���������� ������............................................
 * .............................................................................AT45DB161b.h
 * .............................................................................FM24C64.h
 * ��������.....................................................................10.11.2010 16:26:21
*/

#include "pdef.h"
#include "memm.h"

//------------------------------------------------------------------------------
//���������
//------------------------------------------------------------------------------

#ifndef	MEM
#define MEM
typedef struct
{
	uint32_t adr;																//����� � ����� ������
	uint32_t chip_adr;															//����� � ���������� ���������� ������
} gMEM_;
#endif

extern gMEM_ gMem;

//------------------------------------------------------------------------------
//������� ��� ������ � �������
//------------------------------------------------------------------------------

bool mem_Write_Param(uint32_t adr, const void* data, ubase_t dsize);				//---����� � ��������� + crc � � ��������� � ������ ������
bool mem_Write_ResParam(uint32_t adr, uint32_t res_adr, const void* data, ubase_t dsize);//---���������� � ��������� � ��������� � ������ ������ + crc � � ������ ���������� �����
bool mem_Read_Param(uint32_t adr, void* data, ubase_t dsize);						//---��������� � ��������� + �������� crc
bool mem_Read_ResParam(uint32_t adr, uint32_t res_adr, void *data, ubase_t dsize);	//---������ ������ ��������� + crc � ������ ���������� �����

void mem_Ini(void);																//---�������������� ����� ������
bool mem_Open(dir_t direct);														//---��������� ������ � ����� ������
bool mem_Tx_Byte(uint8_t byte);													//---���������� ���� � ����� ������
bool mem_Rx_Byte(uint8_t* byte);												//---��������� ���� � ����� ������
bool mem_Tx_Data(uint8_t* data, ubase_t dsize);									//---���������� ������ � ����� ������
bool mem_Rx_Data(uint8_t* data, ubase_t dsize);									//---��������� ������ � ����� ������
void mem_Close(dir_t direct);													//---��������� ������ � ����� ������



//------------------------------------------------------------------------------
//������� ��� ����������� ����� ������������� ������
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//								FM24C64
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//����������� ������ ������
//------------------------------------------------------------------------------
#define MEM_FM24C64_ADR_0						FM24C64_ADR_0					//0xA0
#define MEM_FM24C64_ADR_1						FM24C64_ADR_1					//0xA2
#define MEM_FM24C64_ADR_2						FM24C64_ADR_2					//0xA4
//------------------------------------------------------------------------------
//�������
//------------------------------------------------------------------------------
#define MEM_FM24C64_INI(CHIP)					MEM_FM24C64_INI_(CHIP)			//���������������� ������

bool mem_Fm24c64_Open(uint8_t chip, dir_t dir);									//---��������� ������ � ������
ubase_t mem_Fm24c64_Tx_Data(uint8_t* data, ubase_t dsize);						//---����� � ������, ���������� ��������� ����������
ubase_t mem_Fm24c64_Rx_Data(uint8_t* data, ubase_t dsize);						//---������ �� ������, ���������� ��������� ���. ����
void mem_Fm24c64_Close(dir_t dir);												//---��������� ������ � ������



//------------------------------------------------------------------------------
//								AT45DB161B
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//�������
//------------------------------------------------------------------------------
#define MEM_AT45DB161B_INI(CHIP)				MEM_AT45DB161B_INI_(CHIP)		//---�������������� �������� ��� ������
#define MEM_AT45DB161B_OPEN(CHIP)				MEM_AT45DB161B_OPEN_(CHIP)		//---��������� ������ � ��������� ���� ������

ubase_t mem_At45db161b_Tx_Data(uint8_t* data, ubase_t dsize);						//---����� � ������, ���������� ���������� ���������� ������
ubase_t mem_At45db161b_Rx_Data(uint8_t* data, ubase_t dsize);						//---������ �� ������, ���������� ����������� ���. ����
void mem_At45db161b_Close(void);												//---��������� ������ � �����
